
services:
  db:
    image: postgres:12.22-alpine3.21
    container_name: home_db
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DB=home
    volumes:
      - home:/var/lib/postgresql/data # Volume pour persister les donnÃ©es
    ports:
      - "5432:5432"
  rabbit-server:
    image: rabbitmq:3-management
    container_name: rabbit-home
    command: >
      bash -c "rabbitmq-plugins enable rabbitmq_web_stomp && rabbitmq-plugins enable rabbitmq_management && rabbitmq-server"
    ports:
      - 5672:5672
      - 61613:15674
      - 15672:15672
  mqtt:
    image: eclipse-mosquitto:2
    container_name: mqtt_hub
    ports:
      - "1883:1883"
    volumes:
      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
      - ./passwd:/mosquitto/passwd
      -  mq_conf:/mosquitto/config/
      - ./aclfile.acl:/mosquitto/config/aclfile.acl

    restart: unless-stopped

volumes:
  mq_conf:
  home: